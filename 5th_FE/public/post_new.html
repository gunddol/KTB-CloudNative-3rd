<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>게시글 작성</title>
  <link rel="stylesheet" href="/css/style.css"/>
</head>
<body>
  <div class="container">
    <h2>새 게시글</h2>
    <div class="card">
      <div class="form-row"><label>제목</label><input id="title"/></div>
      <div class="form-row"><label>본문</label><textarea id="content"></textarea></div>
      <div class="form-row"><label>이미지 URL 목록(줄바꿈 구분)</label><textarea id="images" placeholder="https://...\nhttps://..."></textarea></div>
      <div class="form-row">
        <button id="btnSave" class="button">등록</button>
        <a href="/" class="button secondary">취소</a>
      </div>
    </div>
  </div>
  <script src="/js/auth.js"></script>
  <script src="/js/api.js"></script>
  <script src="/js/ui.js"></script>
  <script>
    renderNav(); if(!requireLogin('/login')){}
    document.getElementById('btnSave').addEventListener('click', async ()=>{
      const title = document.getElementById('title').value.trim();
      const content = document.getElementById('content').value.trim();
      const images = document.getElementById('images').value.split('\n').map(s=>s.trim()).filter(Boolean);
      if(!title || !content){ alert('제목/본문을 입력하세요.'); return; }
      try{
        const res = await apiFetch('/posts', { method:'POST', body: JSON.stringify({ title, content, image_urls: images }) });
        const id = res?.data?.postId; if(id) location.href='/posts/detail?id='+id; else location.href='/';
      }catch(e){ alert('등록 실패: ' + (e.message||'unknown')); }
    });
  </script>
</body>
</html>
